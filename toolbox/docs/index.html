
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Getting Started with the Baseflow Toolbox</title><meta name="generator" content="MATLAB 9.13"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2023-09-06"><meta name="DC.source" content="bfra_gettingStarted.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Getting Started with the Baseflow Toolbox</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Description</a></li><li><a href="#2">Download</a></li><li><a href="#3">Installation</a></li><li><a href="#7">System Requirements</a></li><li><a href="#9">Accessing Help</a></li><li><a href="#16">Toolbox Features</a></li><li><a href="#23">API Specification</a></li><li><a href="#29">Toolbox Functions</a></li><li><a href="#43">Toolbox Structure</a></li><li><a href="#45">Authors &amp; Sources</a></li><li><a href="#47">Acknowledgements</a></li></ul></div><h2 id="1">Description</h2><p>Baseflow recession analysis is a set of methods in hydrologic science that aim to estimate unobservable aquifer properties, such as hydraulic conductivity, from readily available streamflow records. This toolbox provides high-level MATLAB APIs that standardize the process of conducting baseflow recession analysis using daily streamflow data. The methods implemented in this toolbox are based on solutions to the one-dimensional groundwater flow equation and are intended primarily for application to shallow, unconfined riparian aquifers discharging subsurface flow into adjacent stream channels.</p><h2 id="2">Download</h2><p>Clone or fork the repository <a href="https://github.com/mgcooper/baseflow">on Github</a>.</p><h2 id="3">Installation</h2><p>Place all files and folders in their own folder (e.g. <tt>baseflow</tt>) and then add that folder to the Matlab search path. Alternatively, run the included <tt>Setup.m</tt> installation function:</p><pre class="language-matlab">Setup(<span class="string">'install'</span>) <span class="comment">% for an initial install.</span>
</pre><p>In subsequent sessions:</p><pre class="language-matlab">Setup(<span class="string">'addpath'</span>) <span class="comment">% or just Setup(), to add all toolbox paths to the search path.</span>
</pre><h2 id="7">System Requirements</h2><p>This toolbox depends on the following Mathworks products:</p><div><ul><li><a href="https://www.mathworks.com/products/statistics.html">Statistics and Machine Learning Toolbox</a>&#8482;.</li><li><a href="https://www.mathworks.com/products/curvefitting.html">Curve Fitting Toolbox</a>&#8482;.</li></ul></div><h2 id="9">Accessing Help</h2><p>Need help? To see a list of toolbox functions, at the command window type:</p><pre class="language-matlab">doc <span class="string">+bfra</span>
</pre><p>To see the complete toolbox documentation in the MATLAB Help browser, type:</p><pre class="language-matlab">bfra.help()
</pre><p>To see the documentation for a specific function, type:</p><pre class="language-matlab">bfra.help(<span class="string">'function_name'</span>)
</pre><p>where <tt>function_name</tt> is the name of a toolbox function. For example, <tt>bfra.help('getevents')</tt> opens the help page for <tt>getevents</tt> in the Help browser. Use tab-completion to see the full menu of documented toolbox functions.</p><p>Toolbox documentation can also be accessed by typing <tt>doc()</tt> without any arguments to open the Help browser, then navigate to the documentation home page, scroll down to <b>Supplemental Software</b> at the bottom of the page, and click on <b>Baseflow Recession Analysis Toolbox</b>.</p><h2 id="16">Toolbox Features</h2><p>The toolbox supports three main features:</p><div><ol><li>Baseflow recession event-detection.</li><li>Baseflow recession curve-fitting.</li><li>Aquifer property estimation.</li></ol></div><p>These features are exposed to the user by three APIs (high-level matlab functions that simplify toolbox use):</p><div><ol><li><tt>bfra.getevents</tt> Detect recession events from daily streamflow timeseries.</li><li><tt>bfra.fitevents</tt> Curve-fit all events detected by <tt>getevents</tt>.</li><li><tt>bfra.globalfit</tt> Distribution-fit all parameters estimated with <tt>fitevents</tt>.</li></ol></div><p>The toolbox supports two user-interfaces for passing inputs to these APIs:</p><div><ol><li>Name-value parameter pairs passed directly to the functions.</li><li>An options struct created by <tt>bfra.setopts()</tt>.</li></ol></div><p>Both of these user-interfaces are demonstrated in the example live-scripts in the <tt>demos</tt> folder.</p><h2 id="23">API Specification</h2><p>The API specification for the toolbox is defined below and is also defined in the <tt>setopts</tt> function documentation.</p><p>API specification for <tt><b>getevents</b></tt>:</p><pre>   qmin        :  (numeric scalar) Minimum flow value, below which values are set nan [m3/d]. Default = 1.
   nmin        :  (numeric scalar) Minimum event length. Events with fewer than nmin data values are ignored [#]. Default = 4;
   fmax        :  (numeric scalar) Maximum # of missing flow values gap-filled prior to fitting [#]. Default = 1.
   rmax        :  (numeric scalar) Maximum run-length of sequential constant values, above which an event is ignored [#]. Default = 2.
   rmin        :  (numeric scalar) Maximum allowable rainfall, above which corresponding flow values are set nan. [mm/d]. Default = 1.
   cmax        :  (numeric scalar) Maximum run of sequential convex dQ/dt values, above which flow values are set nan (true) or not (false). Default = 2.
   rmconvex    :  (logical scalar) Flag indicating whether to remove convex derivatives (true) or not (false). Default = false.
   rmnochange  :  (logical scalar) Flag indicating whether to remove consecutive constant derivates(true) or not( false). Default = true.
   rmrain      :  (logical scalar) Flag indicating whether to remove flow values on days with rainfall&gt;rmin (true) or not (false). Default = true.
   pickevents  :  (logical scalar) Flag indicating whether to manually pick events (true) or use automated detection (false). Default = false.
   plotevents  :  (logical scalar) Flag indicating whether to plot picked events. Default = false.
   asannual    :  (logical scalar) Flag indicating whether to detect events on an annual basis. Set true if pickevents true. Default = false.</pre><p>API specification for <tt><b>fitevents</b></tt>:</p><pre>   derivmethod    : (char) derivative (dQ/dt) method. Default = 'ETS'.
   fitmethod      : (char) -dQ/dt = aQb fitting method. Default = 'nls'.
   fitorder       : (numeric scalar) fitting order (value of exponent b) [-]. Default = NaN.
   pickfits       : (logical scalar) Flag indicating whether to pick fits manually. Default = false.
   pickmethod     : (char) Method to fit picks manually. Default = 'none'.
   plotfits       : (logical scalar) Flag indicating whether to plot the fits. Default = false.
   savefitplots   : (logical scalar) Flag indicating whether to save plots of fits. Default = false.
   etsparam       : (numeric scalar) Min flow length parameter for ETS algorithm [-]. Default = 0.2.
   vtsparam       : (numeric scalar) Min flow length parameter for VTS algorithm [-]. Default = 1.0.
   drainagearea   : (numeric scalar) Drainage area upstream of streamflow gauge [m2]. Default = NaN.
   gageID         : (char) Station name or ID. Default = none.</pre><p>API specification for <tt><b>globalfit</b></tt>:</p><pre>     drainagearea      : (numeric scalar) Drainage area upstream of streamflow gauge [m2]. Default = NaN.
     drainagedensity   : (numeric scalar) Drainage density = streamlength/drainagearea [km-1]. Default = 0.8.
     aquiferdepth      : (numeric scalar) Reference aquifer thickness [m]. Default = NaN.
     streamlength      : (numeric scalar) Effective channel length [m]. Default = NaN.
     aquiferslope      : (numeric scalar) Effective aquifer slope [-]. Default = 0.0.
     aquiferbreadth    : (numeric scalar) Distance from channel to catchment divide [m]. Default = NaN.
     drainableporosity : (numeric scalar) Drainable porosity [-]. Default = 0.1.
     isflat            : (logical scalar) Flag indicating true or false. Default = true.
     plotfits          : (logical scalar) Flag indicating whether to plot the various global fits. Default = false.
     bootfit           : (logical scalar) Flag indicating whether to bootstrap the uncertainties. Default = false.
     bootreps          : (numeric scalar) Number of reps for bootstrapping. Default = 1000.
     phimethod         : (char) Method used to fit drainable porosity. Default = 'pointcloud'.
     refqtls           : (numeric vector) Quantiles of Q and -dQ/dt for early/late reference lines (units: N/A). Default = [0.50 0.50].
     earlyqtls         : (numeric vector) Quantiles of Q and -dQ/dt for early reference lines (units: N/A). Default = [0.95 0.95].
     lateqtls          : (numeric vector) Quantiles of Q and -dQ/dt for late reference lines (units: N/A). Default = [0.50 0.50].</pre><h2 id="29">Toolbox Functions</h2><p>Most <tt>baseflow</tt> workflows will revolve around calls to the three primary APIs described above, which implement the underlying methods of baseflow recession analysis by calling both public and private toolbox functions. These functions are described below, organized around the three main toolbox features: event-detection, event-scale curve fitting, and population-scale distribution fitting.</p><p>Event-detection is the process of identifying periods of declining flow in streamflow timeseries, known as "recession events". Curve-fitting refers to parameter estimation from individual recession events. Aquifer properties can be estimated from individual recession event parameters, or from distribution fits to parameter samples estimated from many events, depending on data availability and the intended application.</p><p>Functions that support event detection:</p><div><ul><li><tt>eventfinder</tt> The algorithm called by <tt>getevents</tt> to detect recession events.</li><li><tt>eventpicker</tt> Pick events manually, rather than automatically using <tt>eventfinder</tt>.</li><li><tt>eventplotter</tt> Plot recession events detected by <tt>eventfinder</tt> or <tt>eventpicker</tt></li><li><tt>getdqdt</tt> Estimate the rate of change of discharge <i>dQ/dt</i> prior to curve fitting using one of several numerical differentiation options.</li><li><tt>fitets</tt> Apply the exponential time step method to estimate the numerical derivative <i>dQ/dt.</i></li><li><tt>fitcts</tt> Apply the constant time step method to estimate the numerical derivative <i>dQ/dt.</i></li><li><tt>fitvts</tt> Apply the variable time step method to estimate the numerical derivative <i>dQ/dt.</i></li></ul></div><p>Functions that support aquifer-property estimation:</p><div><ul><li><tt>aquiferprops</tt> Estimate aquifer depth, hydraulic conductivity, and drainable porosity.</li><li><tt>aquiferstorage</tt> Estimate aquifer storage from recession event parameters.</li><li><tt>aquiferthickness</tt> Estimate aquifer thickness from recession event parameters.</li><li><tt>cloudphi</tt> Estimate aquifer drainable porosity using the point cloud method</li><li><tt>expectedQ</tt> Compute the expected value of baseflow.</li><li><tt>fitab</tt> Estimate recession parameters <i>a</i> and <i>b</i> from individual recession events</li><li><tt>eventphi</tt> Estimate drainable porosity from individual recession events</li><li><tt>fitphi</tt> Estimate drainable porosity from individual recession events (called by <tt>eventphi</tt>)</li><li><tt>eventtau</tt> Estimate timescale parameter from individual recession events</li><li><tt>pointcloudintercept</tt> Estimate aquifer parameter <i>a</i> from the point cloud intercept</li></ul></div><p>Functions that support distribution fitting:</p><div><ul><li><tt>plfitb</tt> Fit Pareto distribution to recession timescale parameter tau.</li><li><tt>fitphidist</tt> Fit Beta distribution to drainable porosity.</li><li><tt>gpfitb</tt> Fit Generalized Pareto Distribution to recession parameter tau.</li></ul></div><p>Functions that support aquifer-property change detection:</p><div><ul><li><tt>aquifertrend</tt> Estimate the linear trend in saturated aquifer thickness.</li><li><tt>baseflowtrend</tt> Estimate baseflow trend from annual streamflow timeseries.</li></ul></div><p>Functions used for visualization:</p><div><ul><li><tt>hyetograph</tt> Plot a discharge rainfall hyetograph.</li><li><tt>pointcloudplot</tt> Plot a point-cloud diagram to estimate aquifer parameters</li><li><tt>plotdqdt</tt> (deprecated) Plot the log-log q vs -dq/dt point-cloud with options to select recession segments for fitting</li><li><tt>plotrefline</tt> Add a reference line to a point cloud plot</li><li><tt>plplotb</tt> Plot the power law fit to the P(tau) Pareto distribution</li><li><tt>checkevent</tt> Plot detected recession event and fitted values</li></ul></div><p>Functions that simplify routine tasks:</p><div><ul><li><tt>aQbstring</tt> Return a formatted string for equation aQ^b .</li><li><tt>basinlist</tt> Generate a list of basins in the <tt>baseflow</tt> database.</li><li><tt>basinname</tt> Generate a list of basins in the <tt>baseflow</tt> database.</li><li><tt>characteristicTime</tt> Compute the characteristic e-folding time for aquifer discharge</li><li><tt>conversions</tt> Convert common variables to their equivalent value in terms of another variable</li><li><tt>fdcurve</tt> Compute a flow duration curve from streamflow timeseries.</li><li><tt>getfunction</tt> Get an anonymous function from the toolbox function library</li><li><tt>getstring</tt> Get a latex-formatted string for common variables used for plot labels</li><li><tt>privatefunction</tt> Get an anonymous function for a private toolbox function</li><li><tt>setopts</tt> Set algorithm options for functions getevents, fitevents, and globalfit</li><li><tt>specialfunctions</tt> Libarary of special functions required for recession analysis</li></ul></div><p>Functions that support toolbox management:</p><div><ul><li><tt>completions</tt> Generate function auto-completions for string literals.</li><li><tt>help</tt> Open toolbox html help document in the MATLAB Help browser.</li><li><tt>open</tt> Open package namespace function file in the MATLAB Editor.</li><li><tt>privatefunction</tt> Return handle to function in private/ folder.</li><li><tt>loadExampleData</tt> Load toolbox test data.</li><li><tt>generateTestData</tt> Generate test data.</li></ul></div><h2 id="43">Toolbox Structure</h2><p>All user accessible and documented functions in this toolbox are defined inside the <tt>+bfra</tt> namespace package. This avoids naming conflicts with built-in or user-defined matlab functions. Functions inside <tt>+bfra/private</tt> are available only to functions in the parent <tt>+bfra/</tt> folder and are not meant to be called by users. Functions inside <tt>+bfra/+test</tt> are primarily developer-focused but are accessible to users to run unit tests if desired. Functions inside the +bfra/+deps folder are third-party dependencies and are not meant to be called by the user.</p><pre>+bfra/ - The package, with all documented, user accessible functions.
   +deps/ - Third-party functions called by package functions.
   +sym/ - Symbolic functions accessible to users.
   +test/ - Test functions accessible to users.
   private/ - Undocumented private methods not accessible to users.
data/ - Example datasets.
demos/ - Example live scripts.
docs/ - Documentation.
functionSignatures.json - function signatures to enable auto-completion.
Setup.m - user-facing installation function.</pre><h2 id="45">Authors &amp; Sources</h2><p>The code was written by Matt Cooper (<a href="mailto:matt.cooper@pnnl.gov">&lt;mailto:matt.cooper@pnnl.gov matt.cooper@pnnl.gov</a>&gt;). The exponential time step method implementation was inspired by Clement Roques' exponential time step matlab code (available on request from Clement). The underlying theory is based on idealized solutions to the one-dimensional (lateral) groundwater flow equation ("Boussinesq equation"). Details can be found in the following papers:</p><div><ul><li>Brutsaert W and Nieber J L 1977 Regionalized drought flow hydrographs from a mature glaciated plateau Water Resour. Res. 13 637&#8211;43.</li><li>Brutsaert W and Lopez J P 1998 Basin-scale geohydrologic drought flow features of riparian aquifers in the Southern Great Plains Water Resour. Res. 34 233&#8211;40.</li><li>Rupp D E and Selker J S 2006 On the use of the Boussinesq equation for interpreting recession hydrographs from sloping aquifers Water Resour. Res. 42 W12421.</li></ul></div><h2 id="47">Acknowledgements</h2><p>The Interdisciplinary Research for Arctic Coastal Environments (InteRFACE) project funded this work through the United States Department of Energy, Office of Science, Biological and Environmental Research (BER) Regional and Global Model Analysis (RGMA) program. Awarded under contract grant # 89233218CNA000001 to Triad National Security, LLC (&#8220;Triad&#8221;).</p><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2022b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Getting Started with the Baseflow Toolbox
%% Description
% Baseflow recession analysis is a set of methods in hydrologic science that 
% aim to estimate unobservable aquifer properties, such as hydraulic conductivity, 
% from readily available streamflow records. This toolbox provides high-level 
% MATLAB APIs that standardize the process of conducting baseflow recession analysis 
% using daily streamflow data. The methods implemented in this toolbox are based 
% on solutions to the one-dimensional groundwater flow equation and are intended 
% primarily for application to shallow, unconfined riparian aquifers discharging 
% subsurface flow into adjacent stream channels.
%% Download
% Clone or fork the repository <https://github.com/mgcooper/baseflow on Github>.
%% Installation
% Place all files and folders in their own folder (e.g. |baseflow|) and then 
% add that folder to the Matlab search path. Alternatively, run the included |Setup.m| 
% installation function: 
%%
% 
%   Setup('install') % for an initial install.
%
%% 
% In subsequent sessions:
%%
% 
%   Setup('addpath') % or just Setup(), to add all toolbox paths to the search path.
%
%% System Requirements
% This toolbox depends on the following Mathworks products: 
%% 
% * <https://www.mathworks.com/products/statistics.html Statistics and Machine 
% Learning Toolbox>™. 
% * <https://www.mathworks.com/products/curvefitting.html Curve Fitting Toolbox>™.
%% Accessing Help
% Need help? To see a list of toolbox functions, at the command window type: 
%%
% 
%   doc +bfra
%
%% 
% To see the complete toolbox documentation in the MATLAB Help browser, type:
%%
% 
%   bfra.help()
%
%% 
% To see the documentation for a specific function, type: 
%%
% 
%   bfra.help('function_name')
%
%% 
% where |function_name| is the name of a toolbox function. For example, |bfra.help('getevents')| 
% opens the help page for |getevents| in the Help browser. Use tab-completion 
% to see the full menu of documented toolbox functions.
% 
% Toolbox documentation can also be accessed by typing |doc()| without any arguments 
% to open the Help browser, then navigate to the documentation home page, scroll 
% down to *Supplemental Software* at the bottom of the page, and click on *Baseflow 
% Recession Analysis Toolbox*.
%% Toolbox Features
% The toolbox supports three main features:
%% 
% # Baseflow recession event-detection.
% # Baseflow recession curve-fitting.
% # Aquifer property estimation.
%% 
% These features are exposed to the user by three APIs (high-level matlab functions 
% that simplify toolbox use):
%% 
% # |bfra.getevents| Detect recession events from daily streamflow timeseries.
% # |bfra.fitevents| Curve-fit all events detected by |getevents|.
% # |bfra.globalfit| Distribution-fit all parameters estimated with |fitevents|.
%% 
% The toolbox supports two user-interfaces for passing inputs to these APIs: 
%% 
% # Name-value parameter pairs passed directly to the functions.
% # An options struct created by |bfra.setopts()|.
%% 
% Both of these user-interfaces are demonstrated in the example live-scripts 
% in the |demos| folder. 
%% API Specification
% The API specification for the toolbox is defined below and is also defined 
% in the |setopts| function documentation.
% 
% API specification for |*getevents*|:
%%
% 
%     qmin        :  (numeric scalar) Minimum flow value, below which values are set nan [m3/d]. Default = 1.
%     nmin        :  (numeric scalar) Minimum event length. Events with fewer than nmin data values are ignored [#]. Default = 4;
%     fmax        :  (numeric scalar) Maximum # of missing flow values gap-filled prior to fitting [#]. Default = 1.
%     rmax        :  (numeric scalar) Maximum run-length of sequential constant values, above which an event is ignored [#]. Default = 2.
%     rmin        :  (numeric scalar) Maximum allowable rainfall, above which corresponding flow values are set nan. [mm/d]. Default = 1. 
%     cmax        :  (numeric scalar) Maximum run of sequential convex dQ/dt values, above which flow values are set nan (true) or not (false). Default = 2.
%     rmconvex    :  (logical scalar) Flag indicating whether to remove convex derivatives (true) or not (false). Default = false.
%     rmnochange  :  (logical scalar) Flag indicating whether to remove consecutive constant derivates(true) or not( false). Default = true.
%     rmrain      :  (logical scalar) Flag indicating whether to remove flow values on days with rainfall>rmin (true) or not (false). Default = true.
%     pickevents  :  (logical scalar) Flag indicating whether to manually pick events (true) or use automated detection (false). Default = false.
%     plotevents  :  (logical scalar) Flag indicating whether to plot picked events. Default = false.
%     asannual    :  (logical scalar) Flag indicating whether to detect events on an annual basis. Set true if pickevents true. Default = false.
%
%% 
% API specification for |*fitevents*|:
%%
% 
%     derivmethod    : (char) derivative (dQ/dt) method. Default = 'ETS'.
%     fitmethod      : (char) -dQ/dt = aQb fitting method. Default = 'nls'.
%     fitorder       : (numeric scalar) fitting order (value of exponent b) [-]. Default = NaN.
%     pickfits       : (logical scalar) Flag indicating whether to pick fits manually. Default = false.
%     pickmethod     : (char) Method to fit picks manually. Default = 'none'.
%     plotfits       : (logical scalar) Flag indicating whether to plot the fits. Default = false.
%     savefitplots   : (logical scalar) Flag indicating whether to save plots of fits. Default = false.
%     etsparam       : (numeric scalar) Min flow length parameter for ETS algorithm [-]. Default = 0.2.
%     vtsparam       : (numeric scalar) Min flow length parameter for VTS algorithm [-]. Default = 1.0.
%     drainagearea   : (numeric scalar) Drainage area upstream of streamflow gauge [m2]. Default = NaN.
%     gageID         : (char) Station name or ID. Default = none.
%
%% 
% API specification for |*globalfit*|:
%%
% 
%       drainagearea      : (numeric scalar) Drainage area upstream of streamflow gauge [m2]. Default = NaN.
%       drainagedensity   : (numeric scalar) Drainage density = streamlength/drainagearea [km-1]. Default = 0.8.
%       aquiferdepth      : (numeric scalar) Reference aquifer thickness [m]. Default = NaN.
%       streamlength      : (numeric scalar) Effective channel length [m]. Default = NaN.
%       aquiferslope      : (numeric scalar) Effective aquifer slope [-]. Default = 0.0.
%       aquiferbreadth    : (numeric scalar) Distance from channel to catchment divide [m]. Default = NaN.
%       drainableporosity : (numeric scalar) Drainable porosity [-]. Default = 0.1.
%       isflat            : (logical scalar) Flag indicating true or false. Default = true.
%       plotfits          : (logical scalar) Flag indicating whether to plot the various global fits. Default = false.
%       bootfit           : (logical scalar) Flag indicating whether to bootstrap the uncertainties. Default = false.
%       bootreps          : (numeric scalar) Number of reps for bootstrapping. Default = 1000.
%       phimethod         : (char) Method used to fit drainable porosity. Default = 'pointcloud'.
%       refqtls           : (numeric vector) Quantiles of Q and -dQ/dt for early/late reference lines (units: N/A). Default = [0.50 0.50].
%       earlyqtls         : (numeric vector) Quantiles of Q and -dQ/dt for early reference lines (units: N/A). Default = [0.95 0.95].
%       lateqtls          : (numeric vector) Quantiles of Q and -dQ/dt for late reference lines (units: N/A). Default = [0.50 0.50].
%
%% Toolbox Functions
% Most |baseflow| workflows will revolve around calls to the three primary APIs 
% described above, which implement the underlying methods of baseflow recession 
% analysis by calling both public and private toolbox functions. These functions 
% are described below, organized around the three main toolbox features: event-detection, 
% event-scale curve fitting, and population-scale distribution fitting.
% 
% Event-detection is the process of identifying periods of declining flow in 
% streamflow timeseries, known as "recession events". Curve-fitting refers to 
% parameter estimation from individual recession events. Aquifer properties can 
% be estimated from individual recession event parameters, or from distribution 
% fits to parameter samples estimated from many events, depending on data availability 
% and the intended application.
% 
% Functions that support event detection:
%% 
% * |eventfinder| The algorithm called by |getevents| to detect recession events.
% * |eventpicker| Pick events manually, rather than automatically using |eventfinder|.
% * |eventplotter| Plot recession events detected by |eventfinder| or |eventpicker|
% * |getdqdt| Estimate the rate of change of discharge _dQ/dt_ prior to curve 
% fitting using one of several numerical differentiation options.
% * |fitets| Apply the exponential time step method to estimate the numerical 
% derivative _dQ/dt._
% * |fitcts| Apply the constant time step method to estimate the numerical derivative 
% _dQ/dt._
% * |fitvts| Apply the variable time step method to estimate the numerical derivative 
% _dQ/dt._
%% 
% Functions that support aquifer-property estimation:
%% 
% * |aquiferprops| Estimate aquifer depth, hydraulic conductivity, and drainable 
% porosity.
% * |aquiferstorage| Estimate aquifer storage from recession event parameters.
% * |aquiferthickness| Estimate aquifer thickness from recession event parameters.
% * |cloudphi| Estimate aquifer drainable porosity using the point cloud method
% * |expectedQ| Compute the expected value of baseflow.
% * |fitab| Estimate recession parameters _a_ and _b_ from individual recession 
% events
% * |eventphi| Estimate drainable porosity from individual recession events
% * |fitphi| Estimate drainable porosity from individual recession events (called 
% by |eventphi|)
% * |eventtau| Estimate timescale parameter from individual recession events
% * |pointcloudintercept| Estimate aquifer parameter _a_ from the point cloud 
% intercept
%% 
% Functions that support distribution fitting:
%% 
% * |plfitb| Fit Pareto distribution to recession timescale parameter tau.
% * |fitphidist| Fit Beta distribution to drainable porosity.
% * |gpfitb| Fit Generalized Pareto Distribution to recession parameter tau.
%% 
% Functions that support aquifer-property change detection:
%% 
% * |aquifertrend| Estimate the linear trend in saturated aquifer thickness.
% * |baseflowtrend| Estimate baseflow trend from annual streamflow timeseries.
%% 
% Functions used for visualization:
%% 
% * |hyetograph| Plot a discharge rainfall hyetograph.
% * |pointcloudplot| Plot a point-cloud diagram to estimate aquifer parameters
% * |plotdqdt| (deprecated) Plot the log-log q vs -dq/dt point-cloud with options 
% to select recession segments for fitting
% * |plotrefline| Add a reference line to a point cloud plot
% * |plplotb| Plot the power law fit to the P(tau) Pareto distribution
% * |checkevent| Plot detected recession event and fitted values
%% 
% Functions that simplify routine tasks:
%% 
% * |aQbstring| Return a formatted string for equation aQ^b .
% * |basinlist| Generate a list of basins in the |baseflow| database.
% * |basinname| Generate a list of basins in the |baseflow| database.
% * |characteristicTime| Compute the characteristic e-folding time for aquifer 
% discharge
% * |conversions| Convert common variables to their equivalent value in terms 
% of another variable
% * |fdcurve| Compute a flow duration curve from streamflow timeseries.
% * |getfunction| Get an anonymous function from the toolbox function library
% * |getstring| Get a latex-formatted string for common variables used for plot 
% labels
% * |privatefunction| Get an anonymous function for a private toolbox function
% * |setopts| Set algorithm options for functions getevents, fitevents, and 
% globalfit
% * |specialfunctions| Libarary of special functions required for recession 
% analysis
%% 
% Functions that support toolbox management:
%% 
% * |completions| Generate function auto-completions for string literals.
% * |help| Open toolbox html help document in the MATLAB Help browser.
% * |open| Open package namespace function file in the MATLAB Editor.
% * |privatefunction| Return handle to function in private/ folder.
% * |loadExampleData| Load toolbox test data. 
% * |generateTestData| Generate test data. 
%% Toolbox Structure
% All user accessible and documented functions in this toolbox are defined inside 
% the |+bfra| namespace package. This avoids naming conflicts with built-in or 
% user-defined matlab functions. Functions inside |+bfra/private| are available 
% only to functions in the parent |+bfra/| folder and are not meant to be called 
% by users. Functions inside |+bfra/+test| are primarily developer-focused but 
% are accessible to users to run unit tests if desired. Functions inside the +bfra/+deps 
% folder are third-party dependencies and are not meant to be called by the user.
%%
% 
%  +bfra/ - The package, with all documented, user accessible functions.
%     +deps/ - Third-party functions called by package functions.
%     +sym/ - Symbolic functions accessible to users.
%     +test/ - Test functions accessible to users.
%     private/ - Undocumented private methods not accessible to users.
%  data/ - Example datasets.
%  demos/ - Example live scripts.
%  docs/ - Documentation.
%  functionSignatures.json - function signatures to enable auto-completion.
%  Setup.m - user-facing installation function.
%
%% Authors & Sources
% The code was written by Matt Cooper (<mailto:matt.cooper@pnnl.gov matt.cooper@pnnl.gov>). 
% The exponential time step method implementation was inspired by Clement Roques' 
% exponential time step matlab code (available on request from Clement). The underlying 
% theory is based on idealized solutions to the one-dimensional (lateral) groundwater 
% flow equation ("Boussinesq equation"). Details can be found in the following 
% papers:
%% 
% * Brutsaert W and Nieber J L 1977 Regionalized drought flow hydrographs from 
% a mature glaciated plateau Water Resour. Res. 13 637–43.
% * Brutsaert W and Lopez J P 1998 Basin-scale geohydrologic drought flow features 
% of riparian aquifers in the Southern Great Plains Water Resour. Res. 34 233–40.
% * Rupp D E and Selker J S 2006 On the use of the Boussinesq equation for interpreting 
% recession hydrographs from sloping aquifers Water Resour. Res. 42 W12421.
%% Acknowledgements
% The Interdisciplinary Research for Arctic Coastal Environments (InteRFACE) 
% project funded this work through the United States Department of Energy, Office 
% of Science, Biological and Environmental Research (BER) Regional and Global 
% Model Analysis (RGMA) program. Awarded under contract grant # 89233218CNA000001 
% to Triad National Security, LLC (“Triad”).
##### SOURCE END #####
--></body></html>