
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Getting Started with the Baseflow Recession Analysis Toolbox</title><meta name="generator" content="MATLAB 9.9"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2022-11-08"><meta name="DC.source" content="bfra_gettingStarted.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Getting Started with the Baseflow Recession Analysis Toolbox</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Description</a></li><li><a href="#2">Download</a></li><li><a href="#3">Authors &amp; Sources</a></li><li><a href="#4">System Requirements</a></li><li><a href="#5">Accessing Help</a></li><li><a href="#6">Features</a></li><li><a href="#7">Installation</a></li></ul></div><h2 id="1">Description</h2><p>Baseflow recession analysis refers to a set of methods in hydrologic science designed to infer aquifer properties that cannot be observed, such as hydraulic conductivity, from something that can be observed, such as streamflow. This toolbox provides easy-to-use functions to conduct baseflow recession analysis using measured values of streamflow recorded on a daily timestep. Its application here is meant for shallow (depth &lt;&lt; breadth) unconfined riparian aquifers that discharge subsurface flow into adjacent stream channels.</p><h2 id="2">Download</h2><p>Clone or fork the repository from <a href="https://github.com/mgcooper/baseflow">https://github.com/mgcooper/baseflow</a></p><h2 id="3">Authors &amp; Sources</h2><p>The code was written by Matt Cooper (<a href="mailto:matt.cooper@pnnl.gov">matt.cooper@pnnl.gov</a>) with some code borrowed from Clement Roques' exponential time step matlab code (available on request from Clement). The underlying theory is based on idealized solutions to the one-dimensional (lateral) groundwater flow equation ("Boussinesq equation"). Details can be found in the following papers:</p><div><ul><li>Brutsaert W and Nieber J L 1977 Regionalized drought flow hydrographs from a mature glaciated plateau Water Resour. Res. 13 637&#8211;43.</li><li>Brutsaert W and Lopez J P 1998 Basin-scale geohydrologic drought flow features of riparian aquifers in the Southern Great Plains Water Resour. Res. 34 233&#8211;40.</li><li>Rupp D E and Selker J S 2006 On the use of the Boussinesq equation for interpreting recession hydrographs from sloping aquifers Water Resour. Res. 42 W12421.</li></ul></div><h2 id="4">System Requirements</h2><p>This toolbox depends on the following Mathworks products:</p><div><ul><li>Statistics and Machine Learning Toolbox&#8482; <a href="https://www.mathworks.com/products/statistics.html">https://www.mathworks.com/products/statistics.html</a></li><li>Curve Fitting Toolbox&#8482; <a href="https://www.mathworks.com/products/curvefitting.html">https://www.mathworks.com/products/curvefitting.html</a></li></ul></div><h2 id="5">Accessing Help</h2><p>Need help? Just type</p><pre>doc bfra</pre><h2 id="6">Features</h2><p>The toolbox supports five main features:</p><div><ol><li>Recession (baseflow) event detection</li><li>Recession (baseflow) event curve-fitting</li><li>Recession (baseflow) parameter distribution-fitting</li><li>Aquifer-property estimation from event-scale curve-fitting parameters</li><li>Aquifer-property estimation from population-scale distribution-fitting parameters</li></ol></div><p>Functions that support event detection:</p><div><ul><li><tt>getevents</tt> Detect recession events on a multi-year timeseries of streamflow data, returned as an array</li><li><tt>findevents</tt> Identify recession events from a multi-year timeseries of streamflow data, returned as a cell array (called by <tt>getevents</tt>)</li><li><tt>eventfinder</tt> Automatically detect recession events using objective parameters and filters to detect change points, convert detected recession events into segments (called by <tt>findevents</tt>)</li><li><tt>eventpicker</tt> Pick events manually, rather than automatically using <tt>eventfinder</tt></li><li><tt>eventplotter</tt> Plot recession events detected by <tt>eventfinder</tt> or <tt>eventpicker</tt></li></ul></div><p>Functions that support event fitting:</p><div><ul><li><tt>fitevents</tt> Curve-fit all events using the <tt>Events</tt> output of <tt>getevents</tt></li><li><tt>getdqdt</tt> Estimate the rate of change of discharge dQ/dt prior to curve fitting using one of several numerical differentiation options</li><li><tt>fitdqdt</tt> Estimate the rate of change of discharge dQ/dt prior to curve fitting using one of several numerical differentiation options</li><li><tt>fitets</tt> Apply the exponential time step method to estimate the numerical derivative dQ/dt)</li></ul></div><p>Functions that support distribution fitting:</p><div><ul><li><tt>plfitb</tt> Fit Pareto distribution to timescale parameter tau</li><li><tt>fitphidist</tt> Fit Beta distribution to drainable porosity</li></ul></div><p>Functions that support event-scale aquifer-property estimation:</p><div><ul><li><tt>fitab</tt> Estimate recession parameters <i>a</i> and <i>b</i> from individual recession events</li><li><tt>eventphi</tt> Estimate drainable porosity from individual recession events</li><li><tt>fitphi</tt> Estimate drainable porosity from individual recession events (called by <tt>eventphi</tt>)</li><li><tt>eventtau</tt> Estimate timescale parameter from individual recession events</li><li><tt>eventtau</tt> Estimate timescale parameter from individual recession events</li><li><tt>aquiferstorage</tt> Estimate aquifer storage from individual recession events</li></ul></div><p>Functions that support population-scale aquifer-property estimation:</p><div><ul><li><tt>aquiferprops</tt> Estimate aquifer depth, aquifer hydraulic conductivity, and aquifer drainable porosity using the point cloud method</li><li><tt>aquiferthickness</tt> Estimate aquifer thickness from individual recession events</li><li><tt>cloudphi</tt> Estimate aquifer drainable porosity using the point cloud method</li></ul></div><p>All user accessible functions in this toolbox are defined inside the '+bfra' package. This avoids naming conflicts with built-in matlab functions or any other namespace collision due to user-defined functions. Functions inside bfra.internal are not meant to be called directly.</p><pre>+bfra/  - The package, with all user accessible functions
docs/ - Documentation
demos/ - Example scripts
utils/ - Utility functions required for the package</pre><h2 id="7">Installation</h2><p>Place all files and folders in their own folder (e.g. baseflow) and then add that folder to your Matlab search path. Alternatively, run the included <tt>Setup.m</tt> installation script.</p><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2020b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Getting Started with the Baseflow Recession Analysis Toolbox
% 
%% Description
% Baseflow recession analysis refers to a set of methods in hydrologic science
% designed to infer aquifer properties that cannot be observed, such as
% hydraulic conductivity, from something that can be observed, such as
% streamflow. This toolbox provides easy-to-use functions to conduct baseflow
% recession analysis using measured values of streamflow recorded on a daily
% timestep. Its application here is meant for shallow (depth << breadth)
% unconfined riparian aquifers that discharge subsurface flow into adjacent
% stream channels.
% 
%% Download 
% Clone or fork the repository from <https://github.com/mgcooper/baseflow>
%
%% Authors & Sources
% The code was written by Matt Cooper (matt.cooper@pnnl.gov) with some code
% borrowed from Clement Roques' exponential time step matlab code (available on
% request from Clement). The underlying theory is based on idealized solutions
% to the one-dimensional (lateral) groundwater flow equation ("Boussinesq
% equation"). Details can be found in the following papers: 
% 
% *  Brutsaert W and Nieber J L 1977 Regionalized drought flow hydrographs from
% a mature glaciated plateau Water Resour. Res. 13 637–43.
% *  Brutsaert W and Lopez J P 1998 Basin-scale geohydrologic drought flow
% features of riparian aquifers in the Southern Great Plains Water Resour. Res.
% 34 233–40.
% *  Rupp D E and Selker J S 2006 On the use of the Boussinesq equation for
% interpreting recession hydrographs from sloping aquifers Water Resour. Res. 42
% W12421.
% 
%% System Requirements 
% This toolbox depends on the following Mathworks products:  
%
% *  Statistics and Machine Learning Toolbox(TM) <https://www.mathworks.com/products/statistics.html> 
% *  Curve Fitting Toolbox(TM) <https://www.mathworks.com/products/curvefitting.html> 
% 
%% Accessing Help 
% Need help? Just type 
% 
%  doc bfra
% 
%% Features
% The toolbox supports five main features:
% 
% # Recession (baseflow) event detection
% # Recession (baseflow) event curve-fitting
% # Recession (baseflow) parameter distribution-fitting
% # Aquifer-property estimation from event-scale curve-fitting parameters
% # Aquifer-property estimation from population-scale distribution-fitting
% parameters
% 
% Functions that support event detection:
% 
% * |getevents| Detect recession events on a multi-year timeseries of streamflow data, returned as an array
% * |findevents| Identify recession events from a multi-year timeseries of streamflow data, returned as a cell array (called by |getevents|) 
% * |eventfinder| Automatically detect recession events using objective parameters and filters to detect change points, convert detected recession events into segments (called by |findevents|)
% * |eventpicker| Pick events manually, rather than automatically using |eventfinder|
% * |eventplotter| Plot recession events detected by |eventfinder| or |eventpicker|
% 
% Functions that support event fitting:
% 
% * |fitevents| Curve-fit all events using the |Events| output of |getevents| 
% * |getdqdt| Estimate the rate of change of discharge dQ/dt prior to curve fitting using one of several numerical differentiation options
% * |fitdqdt| Estimate the rate of change of discharge dQ/dt prior to curve fitting using one of several numerical differentiation options
% * |fitets| Apply the exponential time step method to estimate the numerical derivative dQ/dt)
%
% Functions that support distribution fitting:
% 
% * |plfitb| Fit Pareto distribution to timescale parameter tau
% * |fitphidist| Fit Beta distribution to drainable porosity
% 
% Functions that support event-scale aquifer-property estimation:
% 
% * |fitab| Estimate recession parameters _a_ and _b_ from individual recession events
% * |eventphi| Estimate drainable porosity from individual recession events
% * |fitphi| Estimate drainable porosity from individual recession events (called by |eventphi|)
% * |eventtau| Estimate timescale parameter from individual recession events
% * |eventtau| Estimate timescale parameter from individual recession events
% * |aquiferstorage| Estimate aquifer storage from individual recession events
% 
% Functions that support population-scale aquifer-property estimation:
% 
% * |aquiferprops| Estimate aquifer depth, aquifer hydraulic conductivity, and aquifer drainable porosity using the point cloud method
% * |aquiferthickness| Estimate aquifer thickness from individual recession events
% * |cloudphi| Estimate aquifer drainable porosity using the point cloud method
% 
% All user accessible functions in this toolbox are defined inside the '+bfra'
% package. This avoids naming conflicts with built-in matlab functions or any
% other namespace collision due to user-defined functions. Functions inside
% bfra.internal are not meant to be called directly. 
%  
%  +bfra/  - The package, with all user accessible functions
%  docs/ - Documentation
%  demos/ - Example scripts
%  utils/ - Utility functions required for the package
%
%% Installation
% 
% Place all files and folders in their own folder (e.g. baseflow) and then add
% that folder to your Matlab search path.
% Alternatively, run the included |Setup.m| installation script.
%
##### SOURCE END #####
--></body></html>